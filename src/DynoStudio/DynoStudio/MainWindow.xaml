<Window x:Class="Dyno.Forms.MainWindow" Icon="Images/favicon.ico"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:forms="clr-namespace:Dyno.Forms"
        xmlns:wpg="clr-namespace:WPG;assembly=WPG"
        xmlns:dynoStudioUi="clr-namespace:Prorubim.DynoStudioUI;assembly=DynoStudioUI"

        Height="710" Width="1220" WindowStartupLocation="CenterScreen" WindowState="Maximized" Background="{ DynamicResource DarkBackground}" Title="{Binding Title}">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="Themes/MetroDark/MetroDark.MSControls.Core.Implicit.xaml" />
             <!--   <ResourceDictionary Source="Themes/MetroDark/MetroDark.MSControls.Toolkit.Implicit.xaml" /> -->

                <!-- MahApps.Metro resource dictionaries. Make sure that all file names are Case Sensitive! -->
               <!-- <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Controls.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Fonts.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Colors.xaml" />-->
                <!-- Accent and AppTheme setting -->
                <!--<ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/Blue.xaml" />
                <ResourceDictionary Source="pack://application:,,,/MahApps.Metro;component/Styles/Accents/BaseDark.xaml" />-->
                
                <ResourceDictionary Source="/WPG;component/Themes/ExpressionBlend.xaml" />
                <ResourceDictionary Source="Themes/Generic.xaml" />
            </ResourceDictionary.MergedDictionaries>

        </ResourceDictionary>
    </Window.Resources>

    <Grid Margin="5" Name="MainGrid">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        
        
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="{Binding Settings.TreeSplitterWidth}"/>
            <ColumnDefinition Width="Auto"/>
            
            <ColumnDefinition />
            
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="{Binding Settings.UserPropSplitterWidth}"/>

            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="{Binding Settings.PropSplitterWidth}"/>
        </Grid.ColumnDefinitions>

        
        <Grid Margin="0,5,0,15" Grid.ColumnSpan="7">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="250"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <StackPanel Height="106">
                <Image Source="Images/about_single.png" Stretch="UniformToFill" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="0,8,0,0" Width="220"/>
                <StackPanel Margin="5,7,5,7" Orientation="Horizontal" VerticalAlignment="Top" HorizontalAlignment="Left" >
                    <Button Name="Rescan" Style="{StaticResource ToolButton}" Click="RescanButton_OnClick" ToolTip="Rescan Storage" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_refresh.png"/>
                    <Button Name="Save" Style="{StaticResource ToolButton}" Click="SaveButton_OnClick" ToolTip="Save" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_save.png"/>
                    <Button Name="Load" Style="{StaticResource ToolButton}" Click="LoadButton_OnClick" ToolTip="Load" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_load.png"/>


                    <Button Name="Settings" Style="{StaticResource ToolButton}" Click="SettingsButton_OnClick" ToolTip="Settings And Program Info" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_settings.png"/>
                </StackPanel>
            </StackPanel>
            <StackPanel Grid.Column="2" Name="FormEditorTools">
                <WrapPanel>
                    <Border Margin="5,0,5,0"  Padding="5,5,5,5" BorderThickness="1,0,0,0"  BorderBrush="{StaticResource TransBlueColor}">
                        <StackPanel Orientation="Horizontal">

                            <Button Name="Test" Style="{StaticResource ToolButton}" Click="TestButton_OnClick" Content="Run Form" ToolTip="Run Form (F5, Ctrl+T)" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_test.png"/>
                            <Button Name="Undo" Style="{StaticResource ToolButton}" Click="UndoButton_OnClick" ToolTip="Undo (Ctrl+Z)" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_undo.png" IsEnabled="{Binding Path=IsUndo, Mode=OneWay}"/>
                            <Button Name="Redo" Style="{StaticResource ToolButton}" Click="RedoButton_OnClick" ToolTip="Redo (Ctrl+Y)" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_redo.png" IsEnabled="{Binding Path=IsRedo}"/>
                        </StackPanel>
                    </Border>

                    <Border Margin="5,0,5,0"  Padding="5,5,5,5" BorderThickness="1,0,0,0"  BorderBrush="{StaticResource TransBlueColor}">
                        <StackPanel Orientation="Horizontal">

                            <Button Name="Delete" Style="{StaticResource ToolButton}" Click="DelButton_OnClick" ToolTip="Delete Control (Del)" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_delete.png"/>
                            <Button Name="Copy" Style="{StaticResource ToolButton}" Click="CopyButton_OnClick" ToolTip="Copy (Ctrl+C)" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_copy.png"/>
                            <Button Name="Cut" Style="{StaticResource ToolButton}" Click="CutButton_OnClick" ToolTip="Cut (Ctrl+X)" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_cut.png"/>
                            <Button Name="Paste" Style="{StaticResource ToolButton}" Click="PasteButton_OnClick" ToolTip="Paste (Ctrl+V)" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_paste.png"/>
                        </StackPanel>
                    </Border>

                    <Border Margin="5,0,5,0"  Padding="5,5,5,5" BorderThickness="1,0,0,0"  BorderBrush="{StaticResource TransBlueColor}">
                        <StackPanel Orientation="Horizontal">
                            <Button Name="Front" Style="{StaticResource ToolButton}" Click="ButtonFront_OnClick" ToolTip="Bring To Front" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_front.png"/>
                            <Button Name="Back" Style="{StaticResource ToolButton}" Click="ButtonBack_OnClick" ToolTip="Send To Back" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_back.png"/>
                            <ComboBox Height="35" Width="80" VerticalContentAlignment="Center" IsEditable="True">
                                <ComboBox.Text>
                                    <Binding Path="WorkspaceForm.Zoom">
                                        <Binding.Converter>
                                            <dynoStudioUi:ZoomConverter/>
                                        </Binding.Converter>
                                    </Binding>
                                </ComboBox.Text>
                                <ComboBoxItem>160%</ComboBoxItem>
                                <ComboBoxItem>140%</ComboBoxItem>
                                <ComboBoxItem>120%</ComboBoxItem>
                                <ComboBoxItem FontWeight="Bold">100%</ComboBoxItem>
                                <ComboBoxItem>80%</ComboBoxItem>
                                <ComboBoxItem>60%</ComboBoxItem>
                                <ComboBoxItem>40%</ComboBoxItem>
                            </ComboBox>
                        </StackPanel>
                    </Border>
                </WrapPanel>
                <Border  Margin="5,0,5,0" Background="{StaticResource DarkGray}" Padding="5,5,5,5" BorderThickness="1" BorderBrush="{StaticResource TransBlueColor}" HorizontalAlignment="Left">
                    <ScrollViewer HorizontalScrollBarVisibility="Auto">
                        <ScrollViewer.Template>
                            <ControlTemplate TargetType="{x:Type ScrollViewer}">
                                <Grid x:Name="Grid" Background="{TemplateBinding Background}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    <ScrollContentPresenter x:Name="PART_ScrollContentPresenter" CanContentScroll="{TemplateBinding CanContentScroll}" CanHorizontallyScroll="False" CanVerticallyScroll="False" ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" Grid.RowSpan="1" Margin="{TemplateBinding Padding}" Grid.ColumnSpan="2"/>
                                    <ScrollBar x:Name="PART_HorizontalScrollBar" AutomationProperties.AutomationId="HorizontalScrollBar" Cursor="Arrow" Grid.Column="0" Maximum="{TemplateBinding ScrollableWidth}" Minimum="0" Orientation="Horizontal" Grid.Row="1" Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}" Value="{Binding HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" ViewportSize="{TemplateBinding ViewportWidth}" Height="5" MinHeight="5" MaxHeight="5"/>
                                </Grid>
                            </ControlTemplate>
                        </ScrollViewer.Template>
                        <StackPanel Orientation="Horizontal">

                            <Button Tag="tool" Cursor="SizeAll" Name="tSelect" Style="{StaticResource ToolButton}" PreviewMouseLeftButtonDown="s_PreviewMouseLeftButtonDown" AllowDrop="True" Content="Select Button" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_button.png"/>
                            <Button Tag="tool"  Cursor="SizeAll" Name="tTextBox" Style="{StaticResource ToolButton}" PreviewMouseLeftButtonDown="s_PreviewMouseLeftButtonDown" AllowDrop="True" Content="TextBox" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_button.png"/>
                            <Button Tag="tool"  Cursor="SizeAll" Name="tCheckBox" Style="{StaticResource ToolButton}" PreviewMouseLeftButtonDown="s_PreviewMouseLeftButtonDown" AllowDrop="True" Content="CheckBox" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_checkbox.png"/>
                            <Button Tag="tool"  Cursor="SizeAll" Name="tRadioButton" Style="{StaticResource ToolButton}" PreviewMouseLeftButtonDown="s_PreviewMouseLeftButtonDown" AllowDrop="True" Content="RadioButton" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_radiobox.png"/>
                            <Button Tag="tool"  Cursor="SizeAll" Name="tComboBox" Style="{StaticResource ToolButton}" PreviewMouseLeftButtonDown="s_PreviewMouseLeftButtonDown" AllowDrop="True" Content="ComboBox" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_combobox.png"/>
                            <Button Tag="tool"  Cursor="SizeAll" Name="tListBox" Style="{StaticResource ToolButton}"  PreviewMouseLeftButtonDown="s_PreviewMouseLeftButtonDown" AllowDrop="True" Content="ListBox" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_listbox.png"/>
                            <Button Tag="tool"  Cursor="SizeAll" Name="tLabel" Style="{StaticResource ToolButton}" PreviewMouseLeftButtonDown="s_PreviewMouseLeftButtonDown" AllowDrop="True" Content="Label" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_label.png"/>
                            <Button Tag="tool"  Cursor="SizeAll" Name="tImage" Style="{StaticResource ToolButton}" PreviewMouseLeftButtonDown="s_PreviewMouseLeftButtonDown" AllowDrop="True" Content="Image" dynoStudioUi:ToolButtonProps.Image = "Images/forms_control_image.png"/>

                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </StackPanel>
        </Grid>
        
        
        
        <Grid Grid.Row="1" Grid.Column="0" >
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition />
            </Grid.RowDefinitions>
            
            
            <TextBlock Grid.Row="0" Foreground="{StaticResource BlueColor}" FontWeight="Light" FontSize="{StaticResource H2FontSize}"  DockPanel.Dock="Top" Text="Storage Tree" Width="Auto" Height="Auto"  Margin="8" HorizontalAlignment="Left" VerticalAlignment="Center" />
            <TreeView Grid.Row="1" Name="StorageTreeView" Background="{DynamicResource DarkBackground}" ItemsSource="{Binding ChildsMinimal}" Style="{StaticResource StorageTreeViewStyle}" Margin="0,0,0,0" VerticalContentAlignment="Stretch"/>
        </Grid>
        

        <GridSplitter Name="LeftSplitter" MouseDoubleClick="LeftSplitter_OnMouseDoubleClick" Focusable="False" ResizeDirection="Columns" Width="6" HorizontalAlignment="Stretch" BorderThickness="0"  Grid.Row="1" Grid.Column="1"/>
       
        
        
        <TabControl Name="TabControl" Grid.Column="2" Grid.Row="1" BorderThickness="0,1,0,0" Padding="0,10,0,0" Background="Transparent" SelectionChanged="TabControl_OnSelectionChanged">
            <TabControl.Style>
                <Style TargetType="TabControl" BasedOn="{StaticResource MainTabControlStyle}">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding IsPresetSelected}" Value="false">
                            <Setter Property="Visibility" Value="Hidden"></Setter>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </TabControl.Style>
            <TabItem Header="Form Designer" Style="{DynamicResource MainTabItemStyle}">
                <Grid>
                    <StackPanel Name="CreateFormPanel"  VerticalAlignment="Center" HorizontalAlignment="Center" >
                        <Label Style="{DynamicResource H1Label}">Form is not created yet</Label>
                        <Button Name="CreateFormButton" Focusable="False" FontSize="20" BorderBrush="Transparent" HorizontalAlignment="Center" Click="CreateFormButton_Click">Create</Button>
                    </StackPanel>
                    <ScrollViewer  x:Name="BackgroundView" VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto">
                        <dynoStudioUi:BackCanvas x:Name="BackCanvas">
                            <Canvas.LayoutTransform>
                                <ScaleTransform ScaleY="{Binding Path=WorkspaceForm.Zoom, Mode=OneWay }" ScaleX="{Binding Path=WorkspaceForm.Zoom }" />
                            </Canvas.LayoutTransform>
                            <Border MinWidth="100" MinHeight="100" x:Name="FormBorder" BorderThickness="12" BorderBrush="{DynamicResource DarkBackground}" Canvas.Left="30" Canvas.Top="30" >
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="24"/>
                                        <RowDefinition/>
                                        <RowDefinition Height="35"/>
                                    </Grid.RowDefinitions>
                                    <Border Grid.Row="0" x:Name="HeaderBorder" Background="{DynamicResource DarkGray}">
                                        <DockPanel>
                                            <Label FontSize="12" Foreground="{DynamicResource LightGray}" Content="Workspace Name" VerticalContentAlignment="Center"/>
                                            <StackPanel DockPanel.Dock="Right" HorizontalAlignment="Right" Orientation="Horizontal" Margin="2">
                                                <Border Width="14" Background="{DynamicResource Gray}"  Margin="3" />
                                                <Border Width="14" Background="{DynamicResource Gray}" Margin="3" />
                                            </StackPanel>
                                        </DockPanel>
                                    </Border>
                                    <forms:FormTabControl Grid.Row="1" x:Name="FormTabControl" Style="{DynamicResource EditorTabControlStyle}" ItemsSource="{Binding WorkspaceForm.TabItems}" SelectedIndex="{Binding WorkspaceForm.SelectedIndex}" SelectionChanged="FormTabControl_OnSelectionChanged">
                                        <forms:FormTabControl.Resources>
                                            <ResourceDictionary>
                                                <ResourceDictionary.MergedDictionaries>
                                                    <ResourceDictionary Source="Themes/MetroLight/Metro.MSControls.Core.Implicit.xaml" />
                                                    <ResourceDictionary Source="Themes/MetroLight/Metro.MSControls.Toolkit.Implicit.xaml" />
                                                </ResourceDictionary.MergedDictionaries>
                                            </ResourceDictionary>
                                        </forms:FormTabControl.Resources>
                                    </forms:FormTabControl>

                                    <DockPanel Grid.Row="2">
                                        <Button Background="Transparent" BorderThickness="0" BorderBrush="Black" FontSize="14" DockPanel.Dock="Right" IsEnabled="False">Run And Close</Button>
                                        <Button Background="Transparent" BorderThickness="0" BorderBrush="Black" FontSize="14" DockPanel.Dock="Right" IsEnabled="False">Run</Button>
                                        <ComboBox BorderThickness="0" FontSize="14" Name="PresetCombobox" SelectionChanged="Selector_OnSelectionChanged" ItemsSource="{Binding WorkspacePresets}" Focusable="False" SelectedIndex="0">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <ContentPresenter Content="{Binding Name}"/>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </DockPanel>
                                </Grid>

                            </Border>
                        </dynoStudioUi:BackCanvas>
                    </ScrollViewer>
                </Grid>
            </TabItem>
            <TabItem Header="Bootstrap Creator" Style="{DynamicResource MainTabItemStyle}">
                <Grid>
                    <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" Foreground="{DynamicResource LightGray}" Text="Coming soon..." FontSize="48" FontWeight="Light"/>
                </Grid>
            </TabItem>
        </TabControl>


        <GridSplitter MouseDoubleClick="CenterSplitter_OnMouseDoubleClick"  Focusable="False" ResizeDirection="Columns" Width="6" HorizontalAlignment="Stretch" BorderThickness="0"  Grid.Row="1" Grid.Column="3"/>
        
        
        <Border Grid.Column="4" BorderBrush="{DynamicResource BorderBrush}" Grid.Row="1">
            <Grid >
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <TextBlock Grid.Row="0" Foreground="{StaticResource BlueColor}" FontWeight="Light" FontSize="{StaticResource H2FontSize}"  DockPanel.Dock="Top" Text="User Parameters" Width="Auto" Height="Auto"  Margin="8" HorizontalAlignment="Left" VerticalAlignment="Center" />
                <DataGrid x:Name="BindingsDataGrid" Grid.Row="1" AutoGenerateColumns="False" CanUserDeleteRows="True" CanUserAddRows="True" ItemsSource="{Binding WorkspaceForm.UserPars}">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Name" Width="*" Binding="{Binding Name }"/>
                        <DataGridTextColumn Header="Value" Width="*" Binding="{Binding Value}"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
        </Border>


        <GridSplitter  MouseDoubleClick="RightSplitter_OnMouseDoubleClick" Focusable="False" ResizeDirection="Columns" Width="6" HorizontalAlignment="Stretch" BorderThickness="0"  Grid.Row="1" Grid.Column="5"/>
        
        
        <Border Grid.Column="6" BorderBrush="{DynamicResource BorderBrush}" Grid.Row="1">
            <wpg:PropertyGrid Name="PropertyGrid" OverridesDefaultStyle="True" ShowDescription="True" ShowPreview="True"/>
        </Border>
    </Grid>
</Window>